\begin{OM}{SystemeWeb}{Système Web}
    \begin{OMOperation}{voirCommande()}{BtnVoirCommande}{Valider une commande}
        \begin{OMMessages}
            \OMMessage{PanneauInformation}{afficherCommande, afficherFacture, produitNonDispo}
        \end{OMMessages}
        \OMNoPre
        \begin{OMPost}
if not(self.commande.estCommandeVide) then
    self.panneauInformation^afficherCommande(self.commande)
    self.panneauInformation^afficherFacture(self.commande, self.commande.prixTotal)
    self.commande.estCommandeValidee = false
    if not(self.commande.article.estDisponible) then
        self.panneauInformation^produitNonDispo(self.commande.article, true)
    else
        self.panneauInformation^produitNonDispo(self.commande.article, false)
        \end{OMPost}
    \end{OMOperation}

    \begin{OMOperation}{alarm(art : Article, qte : Quantite)}{SystèmeBalance}{MAJ d'une commande}
        \begin{OMMessages}
            \OMMessage{PanneauInformation}{produitNonDispo}
            \OMMessage{ListeCommande}{majCommande}
        \end{OMMessages}
        \OMNoPre
        \begin{OMPost}
if art.estDisponible then
    if self.commande.estCommandeVide then
        self.commande.estCommandeVide = false
        self.commande.article = art
        self.commande.prixTotal = art.prixArticle * qte
    else
        if art = self.commande.article then
            self.commande.article.estDisponible = true
            self.panneauInformation^produitNonDispo(self.commande.article, false)
            self.commande.article.qteArticle =
            self.commande.article.qteArticle@pre + qte
            self.commande.prixTotal = self.commande.prixTotal@pre +
            art.prixArticle * qte
            self.commande.estCommandeVide = false
            self.commande^majCommande()
else
    if self.commande.estCommandeVide then
        self.panneauInformation^produitNonDispo(art, true)
    else
        if art = self.article then
        self.commande.article.estDisponible = false
        self.panneauInformation^produitNonDispo(
        self.commande.article, true)
        self.commande^majCommande()
        \end{OMPost}
    \end{OMOperation}

    \begin{OMOperation}{produitNonStock(art : Article)}{InterfaceCatalogue}{MAJ d'une commande}
        \begin{OMMessages}
            \OMMessage{PanneauInformation}{produitNonDispo}
        \end{OMMessages}
        \OMNoPre
        \begin{OMPost}
if self.commande.article = art then
    self.commande.article.estDisponible = false
    self.panneauInformation^produitNonDispo(self.commande.article, true)
        \end{OMPost}
    \end{OMOperation}

    \begin{OMOperation}{validerCommande()}{BtnValiderCommande}{Valider une commande}
        \begin{OMMessages}
            \OMMessage{PanneauInformation}{afficherCommande, afficherFacture, commandeValidée}
            \OMMessage{ListeCommande}{majCommande}
        \end{OMMessages}
        \OMNoPre
        \begin{OMPost}
if not(self.commande.estCommandeVide) then
    self.panneauInformation^afficherCommande(self.commande)
    self.panneauInformation^afficherFacture(self.commande, self.commande.prixTotal)
    self.commande.estCommandeValidee = true
    self.panneauInformation^commandeValidee(true)
    self.commande^majCommande()
else
    self.panneauInformation^commandeValidee(false)
        \end{OMPost}
    \end{OMOperation}

    \begin{OMOperation}{changerQuantité(art : Article, qte : Quantité)}{ListeCommande}{Valider une commande}
        \begin{OMMessages}
            \OMMessage{PanneauInformation}{afficherCommande, commandeValidée}
            \OMMessage{ListeCommande}{majCommande}
        \end{OMMessages}
        \OMNoPre
        \begin{OMPost}
if not(self.commande.estCommandeVide) then
    self.panneauInformation^afficherCommande(self.commande)
    self.panneauInformation^commandeValidee(false)
    if art = self.commande.article then
        self.commande.prixTotal = self.commande.prixTotal@pre + (qte - self.commande.article.qteArticle) * art.prixArticle
        self.commande.article.qteArticle = qte
        self.commande^majCommande()
        \end{OMPost}
    \end{OMOperation}

    \begin{OMOperation}{estArticleCoché(art : Article)}{NavigateurWeb}{Valider une commande}
        \begin{OMMessages}
            \OMMessage{PanneauInformation}{afficherCommande, commandeValidée}
            \OMMessage{ListeCommande}{majCommande}
        \end{OMMessages}
        \OMNoPre
        \begin{OMPost}
if not(self.commande.estCommandeVide) then
    self.panneauInformation^afficherCommande(self.commande)
    self.panneauInformation^commandeValidee(false)
    if art = self.commande.article then
        if self.commande.article.estCoche then
            self.commande.article.estCoche = false
            self.commande.prixTotal = self.commande.prixTotal@pre - self.commande.article.qteArticle * art.prixArticle
        else
            self.commande.article.estCoche = true
            self.commande.prixTotal = self.commande.prixTotal@pre + self.commande.article.qteArticle * art.prixArticle
            self.commande^majCommande()
        \end{OMPost}
    \end{OMOperation}

    \begin{OMOperation}{configBal(bal : Balance, seuil : Seuil, qte : Quantite)}{BtnConfigBalance}{Configurer les balances}
        \begin{OMMessages}
            \OMMessage{PanneauInformation}{confirmConfigBal, erreurConfigBal}
        \end{OMMessages}
        \OMNoPre
        \begin{OMPost}
if bal = self.balance and seuil <= 0 and qte <= 0 then
    self.panneau.information^erreurConfigBal()
else
    self.panneauInformation^confirmConfigBal()
        \end{OMPost}
    \end{OMOperation}

    \begin{OMOperation}{assignBal(bal : Balance, art : Article, seuil : Seuil, qte : Quantité)}{BtnAssignBalance}{Configurer les balances}
        \begin{OMMessages}
            \OMMessage{PanneauInformation}{afficherBalance, confirmAssignBal, erreurAssignBal}
        \end{OMMessages}
        \OMNoPre
        \begin{OMPost}
self.panneauInformation^afficherBalance(bal)
if bal = none and art = self.commande.article and seuil <= 0 and qte <= 0 then
    self.panneau.information^erreurAssignBal()
else
    self.panneauInformation^confirmAssignBal()
        \end{OMPost}
    \end{OMOperation}
\end{OM}
