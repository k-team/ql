\begin{OM}{SystemeBalance}{Systeme Balance}
    \begin{OMOperation}{demandeMesure()}{CapteurBalance}{Obtenir Mesure}
        \begin{OMMessages}
            \OMMessage{CapteurBalance}{mesure}
        \end{OMMessages}

        \begin{OMPre}
        \end{OMPre}

        \begin{OMPost}
if self.assign != None then
    self.mesure = 0.8 * self.mesure + 0.2 * mesure
if self.mesure < self.seuilMin then
    self.SystemeWeb^alarm(self.quantite)
wait(1 minute)
self.demandeMesure()
        \end{OMPost}
    \end{OMOperation}

    \begin{OMOperation}{scan()}{Systeme externe}{Installation balance}
        \begin{OMMessages}
            \OMMessage{SystemeExterne}{scan(cle)}
        \end{OMMessages}

        \begin{OMPre}
        \end{OMPre}

        \begin{OMPost}
if self.cleClient = cle then
sender^confirmScan
self.synchro = True
self.SystemeWeb = sender
        \end{OMPost}
    \end{OMOperation}

    \begin{OMOperation}{assignBal()}{Systeme web}{Assigner un produit Ã  une balance}
        \begin{OMMessages}
            \OMMessage{SystemeWeb}{assignBal(Prod, Seuil, Quantite)}
        \end{OMMessages}

        \begin{OMPre}
self.synchro = True
        \end{OMPre}

        \begin{OMPost}
sender = self.SystemeWeb
if Seuil >= 0 and Quantite > 0 then
    self.assign = Prod
    self.seuilMin = Seuil
    self.quantite = Quantite and
    self.mesure = 0
    sender^confirmAssign
else
    sender^errorAssign
        \end{OMPost}
    \end{OMOperation}

    \begin{OMOperation}{configBal()}{Systeme web}{Modifier un parametre d'une balance}
        \begin{OMMessages}
            \OMMessage{SystemeWeb}{configBal(Seuil, Quantite)}
        \end{OMMessages}

        \begin{OMPre}
self.synchro = True and self.produit != None
        \end{OMPre}

        \begin{OMPost}
if Seuil >= 0 and Quantite > 0 then
    self.seuilMin = Seuil
    and self.quantite = Quantite and
    self.mesure = 0
    sender^confirmConfig
else
    sender^errorConfig
        \end{OMPost}
    \end{OMOperation}
\end{OM}
